{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "UserMainController",
        "id": "userMainController"
    },
    "name": "MyController",
    "designerId": "19c4cdf1-f966-4805-9519-99c396a5951b",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#countryRegCombo",
                "designer|targetType": "MyComboBox6",
                "fn": "onCountryRegComboChange",
                "implHandler": [
                    "        var state = Ext.getStore('SPStore');",
                    "        var country = Ext.getCmp('countryRegCombo').value;",
                    "        state.filter('CountryName', country);"
                ],
                "name": "change",
                "scope": "me"
            },
            "name": "onCountryRegComboChange",
            "designerId": "53d1982c-aee2-468d-aadb-ad7afdd57438"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#loginBtn",
                "designer|targetType": "MyButton9",
                "fn": "onLoginBtnClick",
                "implHandler": [
                    "var store = Ext.getStore('UserStore');",
                    "var email = Ext.getCmp('emailLoginField').getValue();",
                    "var password = Ext.getCmp('passLoginField').getValue();",
                    "var main = Ext.getCmp('setPanel');",
                    "//             var admin = Ext.getCmp('userPanel');",
                    "var home1 = Ext.getCmp('headerPanel');",
                    "var home2 = Ext.getCmp('subHeaderPanel');",
                    "var home3 = Ext.getCmp('categoryPanel');",
                    "var admin1 = Ext.getCmp('userMgmtBtn');",
                    "var admin2 = Ext.getCmp('prodMgmtBtn'), record = '';",
                    "var isExist = false;",
                    "",
                    "if (!Ext.getCmp('loginPanel').isValid()) {",
                    "\tExt.Msg.alert(\"Login\", \"Please fill out email and password\");",
                    "\treturn;",
                    "}",
                    "Ext.Ajax.request({",
                    "\turl : \"login\",",
                    "\tmethod : \"POST\",",
                    "\tasync : false,",
                    "\tparams : {",
                    "\t\temail : email,",
                    "\t\tpassword : password",
                    "\t},",
                    "\tcallback : function(options, success, response) {",
                    "\t\tif (Ext.isEmpty(response.responseText)) {",
                    "\t\t\tconsole.log('Failed :(');",
                    "\t\t\tExt.Msg.alert(\"User\", \"Sorry but you are prohibited to access this site\");",
                    "\t\t} else if (response.responseText == 'true') {",
                    "\t\t\tconsole.log('Success! :)');",
                    "\t\t\tExt.Ajax.request({",
                    "\t\t\t\turl : \"getUserByEmail\",",
                    "\t\t\t\tmethod : \"GET\",",
                    "\t\t\t\tasync : false,",
                    "\t\t\t\tparams : {",
                    "\t\t\t\t\temail : email",
                    "\t\t\t\t},",
                    "\t\t\t\tcallback : function(options, success, response) {",
                    "\t\t\t\t\tif (!Ext.isEmpty(response.responseText)) {",
                    "\t\t\t\t\t\trecord = Ext.decode(response.responseText);",
                    "                        record = record[0];",
                    "\t\t\t\t\t\tisExist = true;",
                    "\t\t\t\t\t\tif (record.userType == 'A') {",
                    "\t\t\t\t\t\t\tadmin1.show();",
                    "\t\t\t\t\t\t\tadmin2.show();",
                    "\t\t\t\t\t\t}",
                    "\t\t\t\t\t\tstore.add(record);",
                    "\t\t\t\t\t\tExt.Ajax.request({",
                    "\t\t\t\t\t\t\turl : \"getAllProducts\",",
                    "\t\t\t\t\t\t\tmethod : 'GET',",
                    "\t\t\t\t\t\t\tasync : false,",
                    "\t\t\t\t\t\t\tcallback : function(options, success, response) {",
                    "\t\t\t\t\t\t\t\tif (Ext.isEmpty(response.responseText)) {",
                    "\t\t\t\t\t\t\t\t\tExt.Msg.alert(\"Products\",",
                    "\t\t\t\t\t\t\t\t\t\t\t\"Error in getting products\");",
                    "\t\t\t\t\t\t\t\t\tconsole.log('Failed ');",
                    "\t\t\t\t\t\t\t\t} else {",
                    "\t\t\t\t\t\t\t\t\tconsole.log('Success! ');",
                    "\t\t\t\t\t\t\t\t\tvar prodStore = Ext.getStore('ProductStore');",
                    "\t\t\t\t\t\t\t\t\tvar jsonResponse = Ext.JSON.decode(response.responseText);",
                    "\t\t\t\t\t\t\t\t\tprodStore.loadData(jsonResponse);",
                    "\t\t\t\t\t\t\t\t\tvar panel = Ext.getCmp('mainTabPanel');",
                    "\t\t\t\t\t\t\t\t\tvar tab = Ext.getCmp('digitalPanel');",
                    "\t\t\t\t\t\t\t\t\tvar userField = Ext.getCmp('userField');",
                    "\t\t\t\t\t\t\t\t\tvar countField = Ext.getCmp('countField'), idField = Ext.getCmp('idField'), addField = Ext.getCmp('addField');",
                    "\t\t\t\t\t\t\t\t\tpanel.setActiveTab(tab);",
                    "\t\t\t\t\t\t\t\t\tvar controller = W5D5_Project.app.getController('ShopController');",
                    "\t\t\t\t\t\t\t\t\tcontroller.clearItems();",
                    "\t\t\t\t\t\t\t\t\tcontroller.addProductsToPage('digital');",
                    "\t\t\t\t\t\t\t\t\thome1.show();",
                    "\t\t\t\t\t\t\t\t\thome2.show();",
                    "\t\t\t\t\t\t\t\t\thome3.show();",
                    "\t\t\t\t\t\t\t\t\tuserField.setValue(record.userFname);",
                    "\t\t\t\t\t\t\t\t\tidField.setValue(record.userId);",
                    "\t\t\t\t\t\t\t\t\taddField.setValue(record.userAddress1 + ', ' + record.userAddress2 + ', ' + record.userCity + ', ' + record.userSp + ', ' + record.userCountry);",
                    "\t\t\t\t\t\t\t\t\tcountField.setValue(parseInt(countField.getValue()) + 1);",
                    "\t\t\t\t\t\t\t\t}",
                    "\t\t\t\t\t\t\t}",
                    "\t\t\t\t\t\t});",
                    "\t\t\t\t\t}",
                    "\t\t\t\t}",
                    "\t\t\t});",
                    "\t\t} else {",
                    "\t\t\tExt.Msg.alert(\"User\", \"Account does not exist. Login again or register\");",
                    "\t\t}",
                    "\t}",
                    "});",
                    "",
                    "// Ext.each(store.data.items, function(x){",
                    "//     if (x.data.userEmail == email && x.data.userPass == password){",
                    "//         isExist = true;",
                    "//         var type = x.data.userType;",
                    "//         if (type == 'A') {",
                    "//             admin1.show();",
                    "//             admin2.show();",
                    "//         }",
                    "//         record = x;",
                    "//     }",
                    "//     else{",
                    "",
                    "//     }",
                    "// });"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onLoginBtnClick",
            "designerId": "2520b9d5-b5b3-4f4c-ba41-b8145ee36b5a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#registerBtn",
                "designer|targetType": "MyButton10",
                "fn": "onRegisterBtnClick",
                "implHandler": [
                    "var fname = Ext.getCmp('fnameRegField').getValue();",
                    "var lname = Ext.getCmp('lnameRegField').getValue();",
                    "var email = Ext.getCmp('emailRegField').getValue();",
                    "var address1 = Ext.getCmp('address1RegField').getValue();",
                    "var address2 = Ext.getCmp('address2RegField').getValue();",
                    "var city = Ext.getCmp('cityRegField').getValue();",
                    "var sp = Ext.getCmp('spRegCombo').getValue();",
                    "var country = Ext.getCmp('countryRegCombo').getValue();",
                    "var pass = Ext.getCmp('passRegField').getValue();",
                    "var occupation = Ext.getCmp('OccupRegField').getValue();",
                    "var premiumCode1 = Ext.getCmp('pCodeField').getValue();",
                    "var user;",
                    "",
                    "if(!Ext.getCmp('userRegPanel').isValid()){",
                    "    Ext.Msg.alert(\"Register\", \"Please fill out required fields\");",
                    "    return;",
                    "}",
                    "",
                    "Ext.Ajax.request({",
                    "    url : \"premiumRegister\",",
                    "    method: 'POST',",
                    "    params : {",
                    "        premiumCode: premiumCode1",
                    "    },",
                    "    async: false,",
                    "    callback : function(options, success, response){",
                    "        if(response.responseText==='success'){",
                    "            console.log('Valid code');",
                    "            user = {",
                    "    \"userId\":'',",
                    "    \"userFname\":fname,",
                    "    \"userLname\":lname,",
                    "    \"userEmail\":email,",
                    "    \"userPass\":pass,",
                    "    \"userOccupation\":occupation,",
                    "    \"userAddress1\":address1,",
                    "    \"userAddress2\":address2,",
                    "    \"userCity\":city,",
                    "    \"userSp\":sp,",
                    "    \"userCountry\":country,",
                    "    \"userType\":'C',",
                    "    \"userLevel\":2",
                    "};",
                    "        }else{",
                    "            console.log('Invalid code');",
                    "            user = {",
                    "    \"userId\":'',",
                    "    \"userFname\":fname,",
                    "    \"userLname\":lname,",
                    "    \"userEmail\":email,",
                    "    \"userPass\":pass,",
                    "    \"userOccupation\":occupation,",
                    "    \"userAddress1\":address1,",
                    "    \"userAddress2\":address2,",
                    "    \"userCity\":city,",
                    "    \"userSp\":sp,",
                    "    \"userCountry\":country,",
                    "    \"userType\":'C',",
                    "    \"userLevel\":1",
                    "};",
                    "        }",
                    "    }",
                    "});",
                    "",
                    "",
                    "Ext.Ajax.request({",
                    "    url : \"register\",",
                    "    method: 'POST',",
                    "    params : {",
                    "        user: Ext.encode(user)",
                    "    },",
                    "    async: false,",
                    "    jsonData: Ext.util.JSON.encode(user),",
                    "    callback : function(options, success, response){",
                    "        if(response.responseText===''){",
                    "            console.log('Failed :(');",
                    "        }else{",
                    "            console.log('Success! :)');",
                    "            Ext.Msg.alert('User \"' + email + '\" successfully registered!');",
                    "            main.hide();",
                    "            home1.show();",
                    "            home2.show();",
                    "        }",
                    "    }",
                    "});",
                    "",
                    "",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onRegisterBtnClick",
            "designerId": "dfdfe741-dba7-43ea-9be4-a96c3e75a83e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#contactSendBtn",
                "designer|targetType": "MyButton12",
                "fn": "onContactSendBtnClick",
                "implHandler": [
                    "var fname = Ext.getCmp('contactFnameField').getValue();",
                    "var lname = Ext.getCmp('contactLnameField').getValue();",
                    "var concern = Ext.getCmp('contactConcernCombo').getValue();",
                    "var msg = Ext.getCmp('contactMessageText').getValue();",
                    "",
                    "//send email"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onContactSendBtnClick",
            "designerId": "52b1557a-a135-4123-b4f4-6d86c63ce94d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#loginForgotBtn",
                "designer|targetType": "MyButton13",
                "fn": "onLoginForgotBtnClick",
                "implHandler": [
                    "var contact = Ext.getCmp('contactPanel');",
                    "var home1 = Ext.getCmp('mainController');",
                    "",
                    "contact.show();",
                    "home1.hide();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onLoginForgotBtnClick",
            "designerId": "27ec022f-050e-4e00-ae1c-12241cc37352"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#reg1Cntr",
                "designer|params": [
                    "me, field"
                ],
                "designer|targetType": "MyContainer2",
                "fn": "onReg1CntrBeforeAdd",
                "implHandler": [
                    "if (!field.allowBlank){",
                    "field.labelSeparator += '<span style=\"color: rgb(255, 0, 0); padding-left: 2px;\">*</span>';",
                    "}"
                ],
                "name": "beforeadd",
                "scope": "me"
            },
            "name": "onReg1CntrBeforeAdd",
            "designerId": "ab37c064-614c-4e93-ab25-012fc0e581ed"
        }
    ]
}