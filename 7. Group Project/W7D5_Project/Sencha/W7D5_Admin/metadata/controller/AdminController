{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "AdminController"
    },
    "name": "MyController",
    "designerId": "08c0f37d-0a6b-4e3a-912a-64883452181f",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminMenuBtn",
                "designer|targetType": "MyButton",
                "fn": "onAdminMenuBtnClick",
                "implHandler": [
                    "var menu = Ext.getCmp('adminMenuPanel');",
                    "if(menu.hidden){",
                    "    menu.show();",
                    "}else{",
                    "    menu.hide();",
                    "}"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminMenuBtnClick",
            "designerId": "20e325fb-9575-4e0f-be07-2bfb10d3c9ba"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminUserMgmtBtn",
                "designer|targetType": "MyButton19",
                "fn": "onAdminUserMgmtBtnClick",
                "implHandler": [
                    "var panel = Ext.getCmp('adminTabPanel');",
                    "var tab = Ext.getCmp('userMgmtTab');",
                    "panel.setActiveTab(tab);",
                    "Ext.Ajax.request({",
                    "    url : \"getAllUsers\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Users\",\"Error in getting users\");",
                    "        } else {",
                    "            var userStore = Ext.getStore('UserStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            userStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminUserMgmtBtnClick",
            "designerId": "85187e0f-fe69-478e-8ef1-80b80b3119b2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminProdMgmtBtn",
                "designer|targetType": "MyButton20",
                "fn": "onAdminProdMgmtBtnClick",
                "implHandler": [
                    "var panel = Ext.getCmp('adminTabPanel');",
                    "var tab = Ext.getCmp('prodMgmtTab');",
                    "panel.setActiveTab(tab);",
                    "Ext.Ajax.request({",
                    "    url : \"getAllProducts\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Products\",\"Error in getting products\");",
                    "        } else {",
                    "            var prodStore = Ext.getStore('ProductStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            prodStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminProdMgmtBtnClick",
            "designerId": "70dcfbc3-e44e-46fa-89a4-987111c2894f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminOrderMgmtBtn",
                "designer|targetType": "MyButton21",
                "fn": "onAdminOrderMgmtBtnClick",
                "implHandler": [
                    "var panel = Ext.getCmp('adminTabPanel');",
                    "var tab = Ext.getCmp('orderMgmtTab');",
                    "panel.setActiveTab(tab);"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminOrderMgmtBtnClick",
            "designerId": "47f2054d-348e-44ec-8b85-7757a02610c9"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminOnlineUsersBtn",
                "designer|targetType": "MyButton26",
                "fn": "onAdminOnlineUsersBtnClick",
                "implHandler": [
                    "var panel = Ext.getCmp('adminTabPanel');",
                    "var tab = Ext.getCmp('onlineUsersTab');",
                    "panel.setActiveTab(tab);"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminOnlineUsersBtnClick",
            "designerId": "bfb67944-8155-4350-a1dc-8b48189d738b"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminBackBtn",
                "designer|targetType": "MyButton",
                "fn": "onAdminBackBtnClick",
                "implHandler": [
                    "var panel = Ext.getCmp('mainTabPanel');",
                    "var tab = Ext.getCmp('digitalPanel');",
                    "panel.setActiveTab(tab);",
                    "var panel1 = Ext.getCmp('headerPanel'),",
                    "    panel2 = Ext.getCmp('subHeaderPanel'),",
                    "    panel3 = Ext.getCmp('categoryPanel');",
                    "",
                    "panel1.show();",
                    "panel2.show();",
                    "panel3.show();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminBackBtnClick",
            "designerId": "9444d386-a557-4d58-b9ed-47326dbd6a03"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminLoginBtn",
                "designer|targetType": "MyButton18",
                "fn": "onAdminLoginBtnClick",
                "implHandler": [
                    "var store = Ext.getStore('UserStore');",
                    "var email = Ext.getCmp('adminEmail').getValue();",
                    "var password = Ext.getCmp('adminPassword').getValue();",
                    "var main = Ext.getCmp('setPanel');",
                    "var home1 = Ext.getCmp('headerPanel');",
                    "var home2 = Ext.getCmp('subHeaderPanel');",
                    "var home3 = Ext.getCmp('categoryPanel');",
                    "var admin1 = Ext.getCmp('userMgmtBtn');",
                    "var admin2 = Ext.getCmp('prodMgmtBtn'),",
                    "    admin3 = Ext.getCmp('userReqBtn'),",
                    "    admin4 = Ext.getCmp('adminSystemBtn'),",
                    "    menuPanel = Ext.getCmp('adminMenuPanel'),",
                    "    adminMenuContainer = Ext.getCmp('adminMenuContainer'),",
                    "    adminBackContainer = Ext.getCmp('adminBackContainer');",
                    "    record = '';",
                    "var isExist = false;",
                    "",
                    "if (!Ext.getCmp('adminLoginField').isValid()) {",
                    "    Ext.Msg.alert(\"Login\", \"Please fill out email and password\");",
                    "    return;",
                    "}",
                    "Ext.Ajax.request({",
                    "    url : \"login\",",
                    "    method : \"POST\",",
                    "    async : false,",
                    "    params : {",
                    "        email : email,",
                    "        password : password",
                    "    },",
                    "    callback : function(options, success, response) {",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"User\", \"Sorry but you are prohibited to access this site\");",
                    "        } else if (response.responseText == 'true') {",
                    "            Ext.Ajax.request({",
                    "                url : \"getUserByEmail\",",
                    "                method : \"GET\",",
                    "                async : false,",
                    "                params : {",
                    "                    email : email",
                    "                },",
                    "                callback : function(options, success, response) {",
                    "                    if (!Ext.isEmpty(response.responseText)) {",
                    "                        record = Ext.decode(response.responseText);",
                    "                        record = record[0];",
                    "                        isExist = true;",
                    "                        if (record.userType == 'Admin') {",
                    "                            Ext.Ajax.request({",
                    "                                url : \"runAdminConsumer\",",
                    "                                method : \"GET\",",
                    "                                async : false,",
                    "                                callback : function(options, success, response){",
                    "                                    if(response.responseText==1){",
                    "                                        console.log('Run Admin Topic Subscriber');",
                    "                                        store.add(record);",
                    "                                        Ext.Ajax.request({",
                    "                                            url : \"getAllProducts\",",
                    "                                            method : 'GET',",
                    "                                            async : false,",
                    "                                            callback : function(options, success, response) {",
                    "                                                if (Ext.isEmpty(response.responseText)) {",
                    "                                                    Ext.Msg.alert(\"Products\",",
                    "                                                                  \"Error in getting products\");",
                    "                                                } else {",
                    "                                                    var prodStore = Ext.getStore('ProductStore');",
                    "                                                    var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "                                                    prodStore.loadData(jsonResponse);",
                    "                                                    var userField = Ext.getCmp('userField');",
                    "                                                    var countField = Ext.getCmp('countField'),",
                    "                                                        idField = Ext.getCmp('idField'),",
                    "                                                        addField = Ext.getCmp('addField'),",
                    "                                                        emailField = Ext.getCmp('emailField'),",
                    "                                                        levelField = Ext.getCmp('levelField');",
                    "                                                    home1.show();",
                    "                                                    home2.show();",
                    "                                                    home3.show();",
                    "                                                    admin3.show();",
                    "                                                    admin4.show();",
                    "                                                    menuPanel.show();",
                    "                                                    adminMenuContainer.show();",
                    "                                                    adminBackContainer.show();",
                    "                                                    var controller = W5D5_Project.app.getController('ShopController');",
                    "                                                    controller.clearItems();",
                    "                                                    controller.addProductsToPage('digital');",
                    "                                                    userField.setValue(record.userFname);",
                    "                                                    idField.setValue(record.userId);",
                    "                                                    if(Ext.isEmpty(record.userAddress2)){",
                    "                                                       addField.setValue(record.userAddress1 + ', ' + record.userCity + ', ' + record.userSp + ', ' + record.userCountry);",
                    "                                                    }else{",
                    "                                                       addField.setValue(record.userAddress1 + ', ' + record.userAddress2 + ', ' + record.userCity + ', ' + record.userSp + ', ' + record.userCountry);",
                    "                                                    }",
                    "                                                    emailField.setValue(record.userEmail);",
                    "                                                    levelField.setValue(record.userLevel);",
                    "                                                    var adminController = W5D5_Project.app.getController('AdminController');",
                    "                                                    adminController.onAdminUserMgmtBtnClick();",
                    "                                                    Ext.Ajax.request ({",
                    "                                                        url: \"visitorCount\",",
                    "                                                        method: 'GET',",
                    "                                                        async: false,",
                    "                                                        callback : function(options, success, response) {",
                    "                                                            if (success === true) {",
                    "                                                                var count = response.responseText;",
                    "                                                                countField.setValue(count);",
                    "                                                            }",
                    "                                                        }",
                    "                                                    });",
                    "                                                    Ext.Ajax.request ({",
                    "                                                        url: \"favoriteItems\",",
                    "                                                        method: 'POST',",
                    "                                                        params: {",
                    "                                                            userId:Ext.getCmp('idField').getValue()",
                    "                                                        },",
                    "                                                        async: false,",
                    "                                                        callback : function(options, success, response) {",
                    "                                                            if (success === true) {",
                    "                                                                var faveStore = Ext.getStore('FavoriteItemsStore');",
                    "                                                                var result = Ext.JSON.decode(response.responseText);",
                    "                                                                faveStore.loadData(result);",
                    "                                                            }",
                    "                                                        }",
                    "                                                    });",
                    "                                                    Ext.Ajax.request ({",
                    "                                                        url: \"getCartByUser\",",
                    "                                                        method: 'POST',",
                    "                                                        params: {",
                    "                                                            userid:Ext.getCmp('idField').getValue()",
                    "                                                        },",
                    "                                                        async: false,",
                    "                                                        callback : function(options, success, response) {",
                    "                                                            if (success === true) {",
                    "                                                                var cartStore = Ext.getStore('CartProductStore');",
                    "                                                                var resultSet = Ext.JSON.decode(response.responseText);",
                    "                                                                cartStore.loadData(resultSet);",
                    "                                                            }",
                    "                                                        }",
                    "                                                    });",
                    "                                                }",
                    "                                            }",
                    "                                        });",
                    "                                    }",
                    "                                }",
                    "                            });",
                    "                        }else{",
                    "                            Ext.Msg.alert(\"User\", \"Sorry but you are prohibited to access this site\");",
                    "                        }",
                    "                    }",
                    "                }",
                    "            });",
                    "        } else {",
                    "            Ext.Msg.alert(\"User\", \"Login details are invalid.\");",
                    "        }",
                    "    }",
                    "});",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminLoginBtnClick",
            "designerId": "912a3e1a-b3bb-4b46-95c2-58050949b3e0"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminLogoutBtn",
                "designer|targetType": "MyButton32",
                "fn": "onAdminLogoutBtnClick",
                "implHandler": [
                    "Ext.Msg.show({",
                    "    title:'Confirm Logout',",
                    "    message: 'Are you sure you want to log out?',",
                    "    buttons: Ext.Msg.YESNO,",
                    "    icon: Ext.Msg.QUESTION,",
                    "    fn: function(btn) {",
                    "        if (btn === 'yes') {",
                    "            Ext.Ajax.request({",
                    "                url : \"logout\",",
                    "                method : 'POST',",
                    "                async : false,",
                    "                callback : function(options, success, response) {",
                    "                    if (success!==true) {",
                    "                        console.log('Failed ');",
                    "                        Ext.Msg.alert(\"Logout\", \"Error logging out. Try again later.\");",
                    "                    } else {",
                    "                        console.log('Success! ');",
                    "                        Ext.Msg.alert(\"Logout\", \"Successfully logged out!\");",
                    "                        var mainControl = W5D5_Project.app.getController('MainController');",
                    "                        mainControl.clearFrontPage();",
                    "                        var home1 = Ext.getCmp('headerPanel');",
                    "                        var home2 = Ext.getCmp('subHeaderPanel');",
                    "                        var home3 = Ext.getCmp('categoryPanel');",
                    "                        var admin1 = Ext.getCmp('userMgmtBtn');",
                    "                        var admin2 = Ext.getCmp('prodMgmtBtn');",
                    "                        var admin3 = Ext.getCmp('userReqBtn');",
                    "                        var panel2 = Ext.getCmp('cartPanel');",
                    "                        var panel3 = Ext.getCmp('menuPanel');",
                    "                        var tab = Ext.getCmp('adminLoginPanel');",
                    "                        var userField = Ext.getCmp('userField');",
                    "                        var countField = Ext.getCmp('countField'),",
                    "                            idField = Ext.getCmp('idField'),",
                    "                            menuPanel = Ext.getCmp('adminMenuPanel'),",
                    "                            adminMenuContainer = Ext.getCmp('adminMenuContainer'),",
                    "                            adminBackContainer = Ext.getCmp('adminBackContainer'),",
                    "                            admin4 = Ext.getCmp('adminSystemBtn');",
                    "                        menuPanel.setActiveTab(tab);",
                    "                        var controller = W5D5_Project.app.getController('ShopController');",
                    "                        controller.clearItems();",
                    "                        controller.addProductsToPage('digital');",
                    "                        home1.hide();",
                    "                        home2.hide();",
                    "                        home3.hide();",
                    "                        admin1.hide();",
                    "                        admin2.hide();",
                    "                        admin3.hide();",
                    "                        admin4.hide();",
                    "                        panel2.hide();",
                    "                        panel3.hide();",
                    "                        adminMenuContainer.hide();",
                    "                        adminBackContainer.hide();",
                    "                        userField.setValue('Visitor');",
                    "                        idField.setValue(0);",
                    "                        countField.setValue(parseInt(countField.getValue())-1);",
                    "                    }",
                    "                }",
                    "            });",
                    "        }",
                    "    }",
                    "});"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminLogoutBtnClick",
            "designerId": "fce47aef-1359-43f2-9c21-2d864ac97c7e"
        }
    ]
}