{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "OnlineUsersController"
    },
    "name": "MyController",
    "designerId": "21003964-d0c8-43b8-9084-67aeb884a01c",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#onlineUsersSearch",
                "designer|targetType": "Ext.form.field.Text",
                "fn": "onOnlineUsersFieldChange",
                "implHandler": [
                    "var userEmail, onlineUsersStore;",
                    "userEmail = Ext.getCmp('onlineUsersSearch').getValue();",
                    "onlineUsersStore = Ext.getStore('OnlineUsersStore');",
                    "",
                    "if(Ext.isEmpty(userEmail)){",
                    "    onlineUsersStore.clearFilter();",
                    "} else{",
                    "    onlineUsersStore.filter('userEmail',userEmail);",
                    "}"
                ],
                "name": "change",
                "scope": "me"
            },
            "name": "onOnlineUsersFieldChange",
            "designerId": "4fb1dad2-d1b5-4c26-a7da-01f7cf786ab9"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#onlineUsersGrid",
                "designer|targetType": "Ext.grid.Panel",
                "fn": "onOnlineUsersGridDblClick",
                "implHandler": [
                    "var userStore;",
                    "var email = Ext.getCmp('onlineUsersGrid').getSelectionModel().selected.items[0].data.userEmail;",
                    "this.userInfoWindow = Ext.create('W5D5_Project.view.UserInfoWin');",
                    "Ext.Ajax.request({",
                    "    url : \"getUserByEmail\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    params : {",
                    "        email : email",
                    "    },",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Online Users\",",
                    "                          \"Error in retrieving user details\");",
                    "        } else {",
                    "            userStore = Ext.getStore('UserStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            userStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});",
                    "var user = userStore.items[0].data;",
                    "if(this.userInfoWindow!==null){",
                    "    var userLevel;",
                    "    Ext.getCmp('userInfoId').setValue(user.userId);",
                    "    Ext.getCmp('userInfoFname').setValue(user.userFname);",
                    "    Ext.getCmp('userInfoLname').setValue(user.userLname);",
                    "    Ext.getCmp('userInfoEmail').setValue(user.userEmail);",
                    "    Ext.getCmp('userInfoType').setValue(user.userType);",
                    "    if(user.userType == 1){",
                    "        userLevel = 'Normal';",
                    "    } else{",
                    "        userLevel = 'Premium';",
                    "    }",
                    "    Ext.getCmp('userInfoLevel').setValue(userLevel);",
                    "    Ext.getCmp('userInfoImg').setSrc('resources/img/logo.png');",
                    "}",
                    ""
                ],
                "name": "rowdblclick",
                "scope": "me"
            },
            "name": "onOnlineUsersGridDblClick",
            "designerId": "76a73768-bfc6-4256-9483-09337570ec1d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminOnlineUsersBtn",
                "designer|targetType": "Ext.button.Button",
                "fn": "onAdminOnlineUsersClick",
                "implHandler": [
                    "Ext.Ajax.request({",
                    "    url : \"getOnlineUsers\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Online Users\",",
                    "                          \"Error in retrieving onlineUsers\");",
                    "        } else {",
                    "            var onlineUsersStore = Ext.getStore('OnlineUsersStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            userStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});",
                    "Ext.getCmp('onlineUsersGrid').getView().refresh();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminOnlineUsersClick",
            "designerId": "43d683c3-fb16-43dc-9005-d4e3ddbbae3f"
        }
    ]
}