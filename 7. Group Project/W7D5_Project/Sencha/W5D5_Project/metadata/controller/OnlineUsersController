{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "OnlineUsersController"
    },
    "name": "MyController",
    "designerId": "3bce7a55-1490-4ae5-896b-1bfedf98790f",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#onlineUsersSearch",
                "designer|targetType": "Ext.form.field.Text",
                "fn": "onOnlineUsersFieldChange",
                "implHandler": [
                    "var userEmail, onlineUsersStore;",
                    "userEmail = Ext.getCmp('onlineUsersSearch').getValue();",
                    "onlineUsersStore = Ext.getStore('OnlineUsersStore');",
                    "",
                    "if(Ext.isEmpty(userEmail)){",
                    "    onlineUsersStore.clearFilter();",
                    "} else{",
                    "    onlineUsersStore.filter('userEmail',userEmail);",
                    "}"
                ],
                "name": "change",
                "scope": "me"
            },
            "name": "onOnlineUsersFieldChange",
            "designerId": "b198e449-860c-4aac-b367-f760c56d8b91"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#onlineUsersGrid",
                "designer|targetType": "Ext.grid.Panel",
                "fn": "onOnlineUsersGridDblClick",
                "implHandler": [
                    "var userStore;",
                    "var email = Ext.getCmp('onlineUsersGrid').getSelectionModel().selected.items[0].data.userEmail;",
                    "this.userInfoWindow = Ext.create('W5D5_Project.view.UserInfoWin');",
                    "Ext.Ajax.request({",
                    "    url : \"getUserByEmail\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    params : {",
                    "        email : email",
                    "    },",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Online Users\",",
                    "                          \"Error in retrieving user details\");",
                    "        } else {",
                    "            userStore = Ext.getStore('UserStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            userStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});",
                    "var user = userStore.data.items[0].data;",
                    "if(this.userInfoWindow!==null){",
                    "    var userLevel;",
                    "    Ext.getCmp('userInfoId').setValue(user.userId);",
                    "    Ext.getCmp('userInfoFname').setValue(user.userFname);",
                    "    Ext.getCmp('userInfoLname').setValue(user.userLname);",
                    "    Ext.getCmp('userInfoEmail').setValue(user.userEmail);",
                    "    Ext.getCmp('userInfoType').setValue(user.userType);",
                    "    if(user.userType == 1){",
                    "        userLevel = 'Normal';",
                    "    } else{",
                    "        userLevel = 'Premium';",
                    "    }",
                    "    Ext.getCmp('userInfoLevel').setValue(userLevel);",
                    "    Ext.getCmp('userInfoImg').setSrc('resources/img/logo.png');",
                    "    this.userInfoWindow.show();",
                    "}",
                    ""
                ],
                "name": "rowdblclick",
                "scope": "me"
            },
            "name": "onOnlineUsersGridDblClick",
            "designerId": "3b50643f-7b63-461f-8c3e-42baf6554584"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#adminOnlineUsersBtn",
                "designer|targetType": "Ext.button.Button",
                "fn": "onAdminOnlineUsersClick",
                "implHandler": [
                    "Ext.Ajax.request({",
                    "    url : \"getAllOnline\",",
                    "    method : \"GET\",",
                    "    async : false,",
                    "    callback : function(options,success,response){",
                    "        if (Ext.isEmpty(response.responseText)) {",
                    "            Ext.Msg.alert(\"Online Users\",",
                    "                          \"Error in retrieving onlineUsers\");",
                    "        } else {",
                    "            var onlineUsersStore = Ext.getStore('OnlineUsersStore');",
                    "            var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "            onlineUsersStore.loadData(jsonResponse);",
                    "        }",
                    "    }",
                    "});",
                    "Ext.getCmp('onlineUsersGrid').getView().refresh();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAdminOnlineUsersClick",
            "designerId": "2a912e33-257b-412d-9035-a1caa80af9dc"
        }
    ]
}