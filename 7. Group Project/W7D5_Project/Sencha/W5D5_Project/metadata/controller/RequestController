{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "RequestController",
        "id": "requestController"
    },
    "name": "MyController",
    "designerId": "0b9f35a0-b669-48da-8453-4f334c3cd1f1",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#reqApproveBtn",
                "designer|targetType": "MyButton15",
                "fn": "onReqApproveBtnClick",
                "implHandler": [
                    "var requestId,userEmail,userDate,requestStatus,request;",
                    "",
                    "requestId = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.requestId;",
                    "userEmail = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.userEmail;",
                    "userDate = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.userDate;",
                    "",
                    "request = {",
                    "    \"requestId\" : requestId,",
                    "    \"userEmail\" : userEmail,",
                    "    \"userDate\" : userDate,",
                    "    \"requestStatus\" : \"APPROVED\"",
                    "};",
                    "",
                    "Ext.Ajax.request({",
                    "                    url : \"updateRequest\",",
                    "                    method: 'POST',",
                    "                    params : {",
                    "                        id : requestId,",
                    "                        email: userEmail,",
                    "                        date : userDate,",
                    "                        status : \"APPROVED\"",
                    "                    },",
                    "                    async: false,",
                    "                    callback : function(options, success, response){",
                    "                        if (Ext.isEmpty(response.responseText)) {",
                    "                             Ext.Msg.alert(\"Request\",\"Error in approving request\");",
                    "                        } else {",
                    "                             Ext.Msg.alert(\"Request\",\"Success in approving request\");",
                    "                            Ext.Ajax.request({",
                    "                                url : 'updateToPremium',",
                    "                                method : 'POST',",
                    "                                aync : false,",
                    "                                params : {",
                    "                                    email : userEmail",
                    "                                },",
                    "                                callback : function(options, success, response){",
                    "                                    if(response.responseText===true){",
                    "                                        console.log('Success! ');",
                    "                                    }else{",
                    "                                        console.log('Failed! ');",
                    "                                    }",
                    "                                }",
                    "                             });",
                    "                            Ext.Ajax.request({",
                    "                                url : \"getAllRequest\",",
                    "                                method : \"GET\",",
                    "                                async : false,",
                    "                                callback : function(options,success,response){",
                    "                                    if (Ext.isEmpty(response.responseText)) {",
                    "                                        Ext.Msg.alert(\"Requests\", \"Error in getting requests\");",
                    "                                    } else {",
                    "                                        var reqStore = Ext.getStore('RequestStore');",
                    "                                        var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "                                        reqStore.loadData(jsonResponse);",
                    "                                    }",
                    "                                }",
                    "                            });",
                    "                           Ext.getCmp('requestGrid').getView().refresh();",
                    "                        }",
                    "                    }",
                    "                });",
                    "Ext.getCmp('reqFirstName').setValue('');",
                    "Ext.getCmp('reqLastName').setValue('');",
                    "Ext.getCmp('reqAddress1').setValue('');",
                    "Ext.getCmp('reqAddress2').setValue('');",
                    "Ext.getCmp('reqCountry').setValue('');",
                    "Ext.getCmp('reqSp').setValue('');",
                    "Ext.getCmp('reqCity').setValue('');",
                    "Ext.getCmp('reqOccupation').setValue('');",
                    "Ext.getCmp('reqEmail').setValue('');"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onReqApproveBtnClick",
            "designerId": "38fd7ab5-4c9d-420a-9dc0-805357b830b7"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#reqRejectBtn",
                "designer|targetType": "MyButton16",
                "fn": "onReqRejectBtnClick",
                "implHandler": [
                    "var requestId,userEmail,userDate,requestStatus,request;",
                    "",
                    "requestId = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.requestId;",
                    "userEmail = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.userEmail;",
                    "userDate = Ext.getCmp('requestGrid').getSelectionModel().selected.items[0].data.userDate;",
                    "",
                    "request = {",
                    "    \"requestId\" : requestId,",
                    "    \"userEmail\" : userEmail,",
                    "    \"userDate\" : userDate,",
                    "    \"requestStatus\" : \"REJECTED\"",
                    "};",
                    "",
                    "Ext.Ajax.request({",
                    "                    url : \"updateRequest\",",
                    "                    method: 'POST',",
                    "                    params : {",
                    "                        id : requestId,",
                    "                        email: userEmail,",
                    "                        date : userDate,",
                    "                        status : \"REJECTED\"",
                    "                    },",
                    "                    async: false,",
                    "                    callback : function(options, success, response){",
                    "                        if (response.responseText==\"false\") {",
                    "                             Ext.Msg.alert(\"Request\",\"Error in rejecting request\");",
                    "                        } else {",
                    "                             Ext.Msg.alert(\"Request\",\"Success in rejecting request\");",
                    "                            Ext.Ajax.request({",
                    "                                url : \"getAllRequest\",",
                    "                                method : \"GET\",",
                    "                                async : false,",
                    "                                callback : function(options,success,response){",
                    "                                    if (Ext.isEmpty(response.responseText)) {",
                    "                                        Ext.Msg.alert(\"Requests\", \"Error in getting requests\");",
                    "                                    } else {",
                    "                                        var reqStore = Ext.getStore('RequestStore');",
                    "                                        var jsonResponse = Ext.JSON.decode(response.responseText);",
                    "                                        reqStore.loadData(jsonResponse);",
                    "                                    }",
                    "                                }",
                    "                            });",
                    "                            Ext.getCmp('requestGrid').getView().refresh();",
                    "                        }",
                    "                    }",
                    "                });",
                    "Ext.getCmp('reqFirstName').setValue('');",
                    "Ext.getCmp('reqLastName').setValue('');",
                    "Ext.getCmp('reqAddress1').setValue('');",
                    "Ext.getCmp('reqAddress2').setValue('');",
                    "Ext.getCmp('reqCountry').setValue('');",
                    "Ext.getCmp('reqSp').setValue('');",
                    "Ext.getCmp('reqCity').setValue('');",
                    "Ext.getCmp('reqOccupation').setValue('');",
                    "Ext.getCmp('reqEmail').setValue('');"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onReqRejectBtnClick",
            "designerId": "da2d2929-8fb3-418c-b46d-d99814c294fa"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#requestGrid",
                "designer|targetType": "Ext.grid.Panel",
                "fn": "onRequestGridChange",
                "implHandler": [
                    "var user,selected;",
                    "        this.selected = selected;",
                    "        if(!Ext.isEmpty(selected[0])){",
                    "            var gridEmail = selected[0].data.userEmail;",
                    "            Ext.Ajax.request({",
                    "            url : \"getUserByEmail\",",
                    "            method: 'GET',",
                    "            params : {",
                    "                email: gridEmail",
                    "            },",
                    "            async: false,",
                    "            callback : function(options, success, response){",
                    "                if (Ext.isEmpty(response.responseText)) {",
                    "                     Ext.Msg.alert(\"Users\",\"Error in getting Users\");",
                    "                     console.log('Failed ');",
                    "                } else {",
                    "                     console.log('Success! ');",
                    "                     user = Ext.JSON.decode(response.responseText);",
                    "                }",
                    "            }",
                    "        });",
                    "        Ext.getCmp('reqFirstName').setValue(user[0].userFname);",
                    "        Ext.getCmp('reqLastName').setValue(user[0].userLname);",
                    "        Ext.getCmp('reqAddress1').setValue(user[0].userAddress1);",
                    "        Ext.getCmp('reqAddress2').setValue(user[0].userAddress2);",
                    "        Ext.getCmp('reqCountry').setValue(user[0].userCountry);",
                    "        Ext.getCmp('reqSp').setValue(user[0].userSp);",
                    "        Ext.getCmp('reqCity').setValue(user[0].userCity);",
                    "        Ext.getCmp('reqOccupation').setValue(user[0].userOccupation);",
                    "        Ext.getCmp('reqEmail').setValue(user[0].userEmail);",
                    "        }"
                ],
                "name": "selectionchange",
                "scope": "me"
            },
            "name": "onRequestGridChange",
            "designerId": "02927dc0-12a1-4607-90a5-39e2525743ea"
        }
    ]
}